---
import Layout from '../layouts/Layout.astro';
import { TelemetryDashboard } from '../components/TelemetryDashboard';

// Configure your Pico IP and port here
const PICO_IP = import.meta.env.PUBLIC_PICO_IP || 'localhost';
const PICO_PORT = import.meta.env.PUBLIC_PICO_PORT || '8080';
const API_URL = `http://${PICO_IP}:${PICO_PORT}/api/telemetry`;
const USE_MOCK_DATA = import.meta.env.PUBLIC_USE_MOCK_DATA === 'true' || true; // Default to true for development
---

<Layout title="Dashboard - H2At Home">
	<div class="py-8">
		<div class="flex justify-between items-start mb-8">
			<div>
				<h1 class="text-3xl font-bold text-gray-900 mb-2">System Dashboard</h1>
				<p class="text-gray-600">Real-time telemetry from H2At Home system</p>
			</div>
			{USE_MOCK_DATA && (
				<div class="px-3 py-1 bg-yellow-100 border border-yellow-300 rounded-full text-sm font-medium text-yellow-800">
					ðŸ“Š Mock Data Mode
				</div>
			)}
		</div>
		
		<TelemetryDashboard apiUrl={API_URL} useMockData={USE_MOCK_DATA} client:load />

		<div class="mt-8 rounded-lg bg-blue-50 border border-blue-200 p-4">
			<p class="text-sm text-blue-900">
				<strong>Mode:</strong> {USE_MOCK_DATA ? 'ðŸ“Š Simulated data' : 'ðŸ”Œ Live API endpoint'}
			</p>
			{!USE_MOCK_DATA && (
				<p class="text-sm text-blue-900 mt-1">
					<strong>API Endpoint:</strong> <code class="font-mono bg-white px-2 py-1 rounded">{API_URL}</code>
				</p>
			)}
			<p class="text-sm text-blue-900 mt-2">
				Data updates automatically every 1.5 seconds.
			</p>
			<p class="text-sm text-blue-900 mt-2">
				<strong>To switch to live data:</strong> Set <code class="font-mono bg-white px-2 py-1 rounded">PUBLIC_USE_MOCK_DATA=false</code> in <code class="font-mono">.env</code>
			</p>
		</div>
	</div>
</Layout>
